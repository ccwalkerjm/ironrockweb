<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="MobileOptimized" content="320">
    <title>IronRock Insurance</title>

    <!--    @Scripts.Render("~/bundles/modernizr")-->
    <!--@Styles.Render("~/bundles/GlobalCSS")-->
    <link href="/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="/assets/plugins/uniform/css/uniform.default.css" rel="stylesheet">
    <link href="/assets/plugins/bootstrap-datepicker/css/datepicker.css" rel="stylesheet">
    <!--    @Styles.Render("~/bundles/ThemeCSS")-->
    <link href="/assets/css/style-metronic.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">
    <link href="/assets/css/style-responsive.css" rel="stylesheet">
    <link href="/assets/css/plugins.css" rel="stylesheet">
    <link href="/assets/css/pages/tasks.css" rel="stylesheet">
    <link href="/assets/css/themes/default.css" rel="stylesheet">
    <link href="/assets/css/custom.css" rel="stylesheet">
    <link href="/assets/plugins/select2/select2_metro.css" rel="stylesheet">
    <!--@Scripts.Render("~/bundles/jquery")-->
    <script src="/Scripts/jquery-2.2.3.js"></script>
    <script src="/assets/plugins/jquery-migrate-1.2.1.min.js"></script>
    <script src="/assets/plugins/jquery-ui/jquery-ui-1.10.3.custom.min.js"></script>
    <script src="/assets/scripts/app.js"></script>
    <script src="/assets/plugins/bootstrap/js/bootstrap.min.js"></script>
    <script src="/assets/plugins/bootstrap-hover-dropdown/twitter-bootstrap-hover-dropdown.min.js"></script>
    <script src="/assets/plugins/jquery-slimscroll/jquery.slimscroll.min.js"></script>
    <script src="/assets/plugins/jquery.blockui.min.js"></script>
    <script src="/assets/plugins/jquery.cokie.min.js"></script>
    <script src="/assets/plugins/uniform/jquery.uniform.min.js"></script>
    <script src="/assets/plugins/select2/select2.min.js"></script>

</head>

<body class="page-header-fixed">
    <div class="header navbar navbar-inverse navbar-fixed-top" style="background-color:rgb(231,231,231)!important;min-height:60px">
        <div class="header-inner">
            <a class="navbar-brand" href="/index.html">
                <img src="/assets/img/logo.png" id="logo" alt="" class="img-responsive" />
            </a>

            <a href="javascript:;" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <img src="/assets/img/menu-toggler.png" alt="" />
            </a>

            <ul class="nav navbar-nav pull-right">
            </ul>

        </div>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
            </ul>
        </div>
    </div>
    <div class="clearfix" />

    <div class="page-container">
        <div class="page-sidebar-wrapper" id="sidebar"></div>
        <div class="page-content-wrapper">
            <div class="page-content">
                <h1>Forgot Password</h1>
                <div class="row" id="login-block">
                    <div class="col-lg-6">
                        <div id="status"></div>
                        <!--                        <h2>Login</h2>-->
                        <p>Enter your username or email address. A verification code will be sent to your email Address.</p>
                        <form class="form-horizontal" role="form">
                            <div class="form-group">
                                <label class="control-label col-sm-2" for="login_username">Username:</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control" id="login_username" placeholder="Enter Username">
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-offset-2 col-sm-10">
                                    <button type="button" class="btn btn-default" id="forgot_submit">Submit</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer" style="background-color:rgb(231,231,231)!important">
        <div class="footer-inner">
            2016 &copy; Ironrock Insurance.
        </div>
        <div class="footer-tools">
            <span class="go-top">
			    <i class="fa fa-angle-up"></i>
		    </span>
        </div>
    </div>



    <script src="/Scripts/bootbox.js"></script>
    <!--Required Libraries-->
    <script src="/aws/jsbn.js"></script>
    <script src="/aws/jsbn2.js"></script>
    <script src="/aws/sjcl.js"></script>
    <script src="/aws/moment.min.js"></script>
    <script src="/aws/aws-cognito-sdk.min.js"></script>
    <script src="/aws/amazon-cognito-identity.min.js"></script>
    <script src="/aws/aws-sdk-2.3.19.min.js"></script>
    <!--Iron Rock Custom Library-->
    <script src="/aws/ironrockcloudservice.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            var verificationFormText = '<div class="row">  ' +
                '<div class="col-md-12"> ' +
                '<form class="form-horizontal"> ' +
                '<div class="form-group"> ' +
                '<label class="col-md-4 control-label" for="verificationCode">Code</label> ' +
                '<div class="col-md-4"> ' +
                '<input id="verificationCode" name="verificationCode" type="text" placeholder="Verification Code" class="form-control input-md" required> ' +
                '<span class="help-block">Verification Code</span> </div> ' +
                '</div> ' +
                '<div class="form-group"> ' +
                '<label class="col-md-4 control-label" for="password">Password</label> ' +
                '<div class="col-md-4"> ' +
                '<input id="password" name="password" type="password" placeholder="New Password" class="form-control input-md" required> ' +
                '<span class="help-block">Your New Password</span> </div> ' +
                '</div> ' +
                '<div class="form-group"> ' +
                '<label class="col-md-4 control-label" for="confirmPassword">Confirm Password</label> ' +
                '<div class="col-md-4"> ' +
                '<input id="confirmPassword" name="confirmPassword" type="password" placeholder="Confirm Password" class="form-control input-md" required> ' +
                '<span class="help-block">Confirm Password</span> </div> ' +
                '</div> ' +
                '</form> </div>  </div>';

            $('#sidebar').load("/sideBarAnonymous.html", function () {
                App.init();
            });
            //display message
            function display(message, err) {
                if (err) {
                    $('#status').removeClass().addClass('alert alert-warning').html('<strong>Error:</strong>' + message).fadeIn().delay(10000).fadeOut();
                    return;
                }
                $('#status').removeClass().addClass('alert alert-info').html('<strong>Info:</strong>' + message).fadeIn().delay(10000).fadeOut();
            }
            var ir = new ironrockcloudservice();
            ///login
            $("#forgot_submit").click(function (e) {
                ir.forgotPassword($('#login_username').val(), function (err, doVerification, obj) {
                    if (err) {
                        display(err.message, true);
                    } else {
                        if (doVerification) {
                            bootbox.dialog({
                                title: "Confirm Password",
                                message: verificationFormText,
                                buttons: {
                                    success: {
                                        label: "Confirm",
                                        className: "btn-success",
                                        callback: function () {
                                            var verificationCode = $('#verificationCode').val();
                                            var newPassword = $('#password').val();
                                            var confirmPassword = $('#confirmPassword').val();
                                            if (!verificationCode || !newPassword || newPassword != confirmPassword)
                                                return false;
                                            else
                                                ir.confirmPassword(verificationCode, newPassword, obj);
                                        }
                                    }
                                }
                            });
                        } else {
                            display("Your password has been set. You can now login.", false);
                        }
                    }
                });
            });

        });
    </script>




</body>

</html>